#### Topk
# wandb_project: spd-piecewise
# wandb_run_name: null
# wandb_run_name_prefix: "rp_"
# spd_type: rank_penalty
# unit_norm_matrices: false
# seed: 0
# topk: 0.114
# batch_size: 10000
# batch_topk: true
# param_match_coeff: 0.5
# topk_recon_coeff: 1
# topk_l2_coeff: null
# schatten_coeff: 0.7
# pnorm: 1.0
# lr: 0.01
# steps: 50_000
# print_freq: 500
# image_freq: 5_000
# slow_images: true
# save_freq: 50_000
# lr_warmup_pct: 0.004
# lr_schedule: cosine
# task_config:
#   task_name: piecewise
#   n_functions: 2
#   neurons_per_function: 3
#   n_layers: 1
#   feature_probability: 0.05
#   range_min: 0
#   range_max: 5
#   k: 2
#   init_scale: 1.0
#   simple_bias: false
#   handcoded_AB: false

###### Lp 2f_3n_1l
# wandb_project: spd-piecewise
# wandb_run_name: null
# wandb_run_name_prefix: "rp_"
# spd_type: rank_penalty
# unit_norm_matrices: false
# m: null
# seed: 0
# topk: null
# batch_size: 512
# pnorm: 0.3
# lp_sparsity_coeff: 10
# param_match_coeff: 1
# out_recon_coeff: 1e3
# schatten_pnorm: 1.0
# schatten_coeff: 10
# lr: 0.01
# steps: 30_000
# print_freq: 500
# image_freq: 5_000
# slow_images: true
# save_freq: 30_000
# lr_warmup_pct: 0.004
# lr_schedule: cosine
# task_config:
#   task_name: piecewise
#   n_functions: 2
#   neurons_per_function: 3
#   n_layers: 1
#   feature_probability: 0.05
#   range_min: 0
#   range_max: 5
#   k: 2
#   init_scale: 1.0
#   simple_bias: false
#   handcoded_AB: false

###### Rank one 2f_6n_2l
wandb_project: spd-piecewise
wandb_run_name: null
wandb_run_name_prefix: "rp_"
spd_type: rank_penalty
unit_norm_matrices: false
m: null
seed: 0
topk: null
batch_size: 512
pnorm: 0.3
lp_sparsity_coeff: 10
param_match_coeff: 1
out_recon_coeff: 1e3
schatten_pnorm: 1.0
schatten_coeff: 10
lr: 0.01
steps: 30_000
print_freq: 500
image_freq: 5_000
slow_images: true
save_freq: 30_000
lr_warmup_pct: 0.004
lr_schedule: cosine
task_config:
  task_name: piecewise
  n_functions: 2
  neurons_per_function: 6
  n_layers: 1
  feature_probability: 0.05
  range_min: 0
  range_max: 5
  k: 2
  init_scale: 1.0
  simple_bias: false
  handcoded_AB: true

###### Lp 4f_2l (not validated)
# wandb_project: spd-piecewise
# wandb_run_name: null
# wandb_run_name_prefix: "rp_"
# spd_type: rank_penalty
# unit_norm_matrices: false
# m: null
# seed: 0
# topk: null
# batch_size: 512
# pnorm: 0.3
# lp_sparsity_coeff: 10
# param_match_coeff: 1
# out_recon_coeff: 1e3
# schatten_pnorm: 1.0
# schatten_coeff: 10
# lr: 0.01
# steps: 30_000
# print_freq: 500
# image_freq: 5_000
# slow_images: true
# save_freq: 30_000
# lr_warmup_pct: 0.004
# lr_schedule: cosine
# task_config:
#   task_name: piecewise
#   n_functions: 4
#   neurons_per_function: 10
#   n_layers: 2
#   feature_probability: 0.05
#   range_min: 0
#   range_max: 5
#   k: 4
#   init_scale: 1.0
#   simple_bias: false
#   handcoded_AB: false

####### topk with larger n_functions and neurons
# wandb_project: spd-piecewise
# wandb_run_name: null
# wandb_run_name_prefix: "rp"
# spd_type: rank_penalty
# unit_norm_matrices: false
# seed: 0
# topk: 0.625
# batch_size: 2048
# batch_topk: true
# param_match_coeff: 5.0
# topk_recon_coeff: 0.1
# topk_l2_coeff: null
# schatten_coeff: 3e-1
# pnorm: null
# lr: 0.01
# steps: 50_000
# print_freq: 500
# image_freq: 10_000
# slow_images: true
# save_freq: 50_000
# lr_warmup_pct: 0.004
# lr_schedule: cosine
# task_config:
#   task_name: piecewise
#   n_functions: 10
#   neurons_per_function: 10
#   n_layers: 1
#   feature_probability: 0.05
#   range_min: 0
#   range_max: 5
#   k: 10
#   init_scale: 1.0
#   simple_bias: false
#   handcoded_AB: false
