program: spd/experiments/piecewise/piecewise_decomposition.py
method: random
metric:
  name: topk_recon_loss
  goal: minimize
parameters:
  lr:
    values: [0.01, 1e-3, 3e-3]
  topk_recon_coeff:
    values: [1, 0.5, 5.0]
  topk_schatten_coeff:
    values: [0.7, 0.5, 5.0]
  param_match_coeff:
    values: [0.5, 0.1, 2.0]
  pnorm:
    values: [1.0, 0.5, 0.7]

command:
- ${env}
- ${interpreter}
- ${program}
- spd/experiments/piecewise/sweep2.yaml
